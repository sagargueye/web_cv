System.register(["./chunk-vendor.js","./chunk-frameworks.js"],function(w){"use strict";var c,I,$,u,x,y,T,A,S,d;return{setters:[function(a){c=a.t,I=a.f,$=a.e,u=a.g,x=a.u},function(a){y=a.m,T=a.d,A=a.f,S=a.b,d=a.r}],execute:function(){w("m",a);function a(e={}){return(t,i,s)=>{s.value=y(s.value,e),Object.defineProperty(t,i,s)}}var R=Object.defineProperty,E=Object.getOwnPropertyDescriptor,O=(e,t)=>R(e,"name",{value:t,configurable:!0}),g=(e,t,i,s)=>{for(var r=s>1?void 0:s?E(t,i):t,n=e.length-1,h;n>=0;n--)(h=e[n])&&(r=(s?h(t,i,r):h(r))||r);return s&&r&&R(t,i,r),r};const Q=new Map,v=class extends HTMLElement{constructor(){super(...arguments);this.showAllQualifiersIfNoneMatch=!0,this.fuzzyMatchQualifiers=!1,this.fuzzyMatchValues=!0,this.showSubmissionOptionIfInvalidSearchTerms=!1,this.suggestionsTitle="Available filters",this.spaceBetweenValueAndDescription=!0,this.selectorOfElementToActivateOnBlur=null,this.alphaTag=v.tagFn("Alpha"),this.betaTag=v.tagFn("Beta")}async cachedJSON(e){const t=await fetch(e,{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(!t.ok){const i=new Error,s=t.statusText?` ${t.statusText}`:"";throw i.message=`HTTP ${t.status}${s}`,i}return t.json()}fetchQualifierSuggestions(){const e="data-suggestable-qualifiers",t=this.searchInput.getAttribute(e);if(t===null)throw new Error(`
        ${e} is missing from ${this.searchInput.getAttribute("data-target")}.
        Either add it or override fetchQualifierSuggestions.
      `);return JSON.parse(t)}negatableQualifiers(){return JSON.parse(this.searchInput.getAttribute("data-negatable-qualifiers")||"[]")}removeNegationFromQualifierIfSupported(e){if(!e.startsWith("-"))return e;let[t,...i]=e.split(":");const s=t.substring(1);return this.negatableQualifiers().includes(s)&&(t=s),e.includes(":")&&(t+=":"),(i==null?void 0:i.length)>0?`${t}${i.join(":")}`:t}fetchSuggestionsForQualifier(e){e=this.removeNegationFromQualifierIfSupported(e);const t=`data-suggestable-${e}`,i=`data-suggestable-${e}-path`;if(this.searchInput.hasAttribute(t))return JSON.parse(this.searchInput.getAttribute(t)||"[]");if(this.searchInput.hasAttribute(i)){const s=this.searchInput.getAttribute(i);if(!s)throw new Error(`${i} not set`);return this.cachedJSON(s)}else return Promise.resolve([])}hideFilterSuggestions(){T(this.searchForm),this.autocompleteDropdown.hidden=!0,this.searchInput.setAttribute("aria-expanded","false")}updateFilterSuggestionResults(){const e=this.searchInput.value,i=(e.slice(0,this.searchInput.selectionEnd).match(/(:"[^"]+"?|\S)+$/)||[""])[0].replace(/"/g,"");this.autocompleteDropdown.hidden=!1,this.searchInput.setAttribute("aria-expanded","true");let s,r;i.includes(":")?[s,...r]=i.split(":"):s=i,r!=null?this.renderValueSuggestions(s,r.join(":")):this.renderQualifierSuggestions(s),e.trim().length>0&&(!this.invalidSearchTerms()||this.showSubmissionOptionIfInvalidSearchTerms)&&!this.searchMatchesDefault()?(this.clearButton&&(this.clearButton.hidden=!1),A(this.searchForm)):(this.clearButton&&(this.clearButton.hidden=!0),S(this.searchForm))}handleSelectedSuggestionResultEvent(e){var t;const i=e.target;if(i.hasAttribute("data-search")){d(this.searchForm);return}let s=i.getAttribute("data-value")||"";s[s.length-1]!==":"&&(s+=" ");const r=this.searchInput.value.slice(0,this.searchInput.selectionEnd),n=((t=r.match(/(\S+)$/))==null?void 0:t.pop())||"",h=this.searchInput.value.slice(this.searchInput.selectionEnd),m=h[0]!==" "?" ":"";if(n&&(n.startsWith("-")&&!s.startsWith("-")&&(s=`-${s}`),n.includes(","))){const f=n.split(",");f.pop();const b=s.split(":").slice(1).join(":");f.push(b||""),s=f.join(",")}const o=r.replace(/\S+$/,"");this.searchInput.value=o+s+m+h,e.preventDefault(),this.searchInput.focus();const p=o.length+s.length;this.searchInput.setSelectionRange(p,p),I(this.searchInput,"input")}handleFormKeydownEvent(e){if(e.detail.hotkey==="Enter"){if(this.autocompleteResults.querySelector(".js-filter-loading")||this.autocompleteResults.querySelector(".js-navigation-item.navigation-focus"))return;d(this.searchForm)}}clear(){this.searchInput.value=this.getDefaultSearch(),this.getInitialValue().trim().length===0?this.updateFilterSuggestionResults():d(this.searchForm)}renderQualifierSuggestions(e){this.showAllQualifiersIfNoneMatch?this.renderMatchingOrAllQualifierSuggestions(e):this.renderMatchingQualifierSuggestions(e)}renderMatchingOrAllQualifierSuggestions(e){const t=this.fetchQualifierSuggestions(),i=this.filterSuggestionsList(t,e,{fuzzy:this.fuzzyMatchQualifiers}).then(s=>s.length===0?t:s);this.renderSuggestionDropdown(i)}renderMatchingQualifierSuggestions(e){const t=this.filterSuggestionsList(this.fetchQualifierSuggestions(),e,{fuzzy:this.fuzzyMatchQualifiers});this.renderSuggestionDropdown(t)}renderValueSuggestions(e,t){const i=this.fetchMatchingSuggestions(e,t);this.renderSuggestionDropdown(i)}async fetchMatchingSuggestions(e,t){const i=this.fetchSuggestionsForQualifier(e),s=t.split(",").pop()||"";return(await this.filterSuggestionsList(i,s,{fuzzy:this.fuzzyMatchValues})).map(n=>({value:`${e}:${n.value}`,description:n.description}))}async filterSuggestionsList(e,t,{fuzzy:i}={fuzzy:!0}){const s=await e;let r=t.trim().toLowerCase();return!r||r.length===0?s:(r.startsWith("-")&&(r=r.slice(1)),s.filter(n=>i?n.value.toLowerCase().includes(r):n.value.toLowerCase().startsWith(r)))}renderSuggestionDropdown(e){$(u`
        <div>
          ${this.renderSearchWarningIfRequired()}
          ${this.shouldRenderSubmissionOption()?this.renderSearchSuggestion():""}
          ${x(this.renderSuggestionList(e),this.renderLoadingItem())}
        </div>
      `,this.autocompleteResults),this.postDropdownRender()}renderSearchWarningIfRequired(){const e=this.invalidSearchTerms();if(!e||e.length===0)return"";let t=u``;const i=this.getFilterSupportURL();return i&&(t=u`<a class="js-navigation-item js-navigation-open px-1" href="${i}" target="_blank">
        Learn more about filters.
      </a>`),u`
      <div class="color-bg-attention color-fg-muted ml-n2 mr-n2 mt-n1 py-1 px-2 js-search-warning-container">
        Sorry, we don't support the <span class="text-bold">${e}</span> filter yet. ${t}
      </div>
    `}getFilterSupportURL(){return this.searchInput.getAttribute("data-filter-support-url")}postDropdownRender(){}renderSearchSuggestion(){const e=this.searchInput.value.trim();return e.length===0?u``:/:\s|:$/g.test(e)&&!/(?:\w+:){2,}/g.test(e)?u``:u`
      <div class="border-bottom-0 rounded-1 py-1 px-2 mx-0 mb-1 js-navigation-item" data-search="true">
        <span class="text-bold">${e}</span> - submit
      </div>
    `}invalidSearchTerms(){const e=this.fetchQualifierSuggestions().map(o=>o.value),t=new RegExp(/[^\s:]+:/),i=new RegExp(/"(?:\\"|.)*?"/),s=new RegExp(`${t.source}(?:${i.source}|[^\\s]*)`),r=new RegExp(/[^\s]+/),n=new RegExp(`${s.source}|${r.source}`,"g"),m=(this.searchInput.value.match(n)||[]).filter(o=>{o=this.removeNegationFromQualifierIfSupported(o);const p=o.indexOf(":");if(p===-1)return!1;{const f=o.substr(0,p+1);return!e.some(b=>b===f)}});return m.length===0?null:m.join(" ")}searchMatchesDefault(){return this.searchInput.value.trim()===this.getDefaultSearch().trim()}getInitialValue(){const e="data-initial-value",t=this.searchInput.getAttribute(e);if(t===null)throw new Error(`${e} is missing from search input`);return t}getDefaultSearch(){const e="data-default-value",t=this.searchInput.getAttribute(e);if(t===null)throw new Error(`${e} is missing from search input`);return t}renderSuggestionsTitle(){return u`<h6 class="width-full text-normal border-bottom color-bg-default color-fg-muted py-2 mb-2">
      ${this.suggestionsTitle}
    </h6>`}async renderSuggestionList(e){const i=(await e).map(s=>u`
          <div
            class="border-bottom-0 rounded-1 py-1 px-2 mx-0 mb-1 js-navigation-item"
            data-value="${s.value}"
          >
            <span class="text-bold">${s.value}</span>${this.spaceBetweenValueAndDescription?" ":""}<span
              class="autocomplete-text-qualifier color-fg-muted"
              >&nbsp;${s.description}</span
            >
            ${s.isAlpha&&this.alphaTag} ${s.isBeta&&this.betaTag}
          </div>
        `);return i.length&&i.unshift(this.renderSuggestionsTitle()),i}renderLoadingItem(){return u`
      ${this.renderSuggestionsTitle()}
      <span class="js-filter-loading">loading...</span>
    `}handleSearchBlur(){this.hideFilterSuggestions(),this.selectorOfElementToActivateOnBlur&&S(document.querySelector(this.selectorOfElementToActivateOnBlur))}inputKey(e){e.key==="Escape"&&this.handleSearchBlur()}shouldRenderSubmissionOption(){return this.showSubmissionOptionIfInvalidSearchTerms||!this.invalidSearchTerms()}static tagFn(e){return u`<span class="lh-condensed px-1 rounded-1 border color-border-success">${e}</span>`}};let l=w("B",v);O(l,"BaseFilterElement"),g([c],l.prototype,"autocompleteDropdown",2),g([c],l.prototype,"autocompleteResults",2),g([c],l.prototype,"clearButton",2),g([c],l.prototype,"searchForm",2),g([c],l.prototype,"searchInput",2),g([a({cache:Q})],l.prototype,"cachedJSON",1)}}});
//# sourceMappingURL=chunk-filter-input-41ed0fc1.js.map
