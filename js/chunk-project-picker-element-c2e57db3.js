System.register(["./chunk-vendor.js"],function(){"use strict";var o,m,d,p;return{setters:[function(a){o=a.t,m=a.c,d=a.T,p=a.p}],execute:function(){var a=Object.defineProperty,h=Object.getOwnPropertyDescriptor,f=(e,t)=>a(e,"name",{value:t,configurable:!0}),c=(e,t,i,r)=>{for(var s=r>1?void 0:r?h(t,i):t,l=e.length-1,u;l>=0;l--)(u=e[l])&&(s=(r?u(t,i,s):u(s))||s);return r&&s&&a(t,i,s),s};let n=class extends HTMLElement{constructor(){super(...arguments);this.loading=!0,this.selectionDiff={memex_project:{},project:{}}}connectedCallback(){this.loadChanges(),this.input.filter=(t,i)=>t&&t.name.toLowerCase().trim().includes(i.toLowerCase());const e=this.closest("details.select-menu");e&&this.list&&e.addEventListener("toggle",()=>{if(e.open===!1){this.input.clear();return}this.list.update()})}willLoad(){this.loading=!0,this.loadingIndicator.removeAttribute("hidden"),this.blankslate.hidden=!0,this.input.reset()}didLoad(){this.loading=!1,this.loadingIndicator.setAttribute("hidden","true")}changeTab(e){const t=e.detail.relatedTarget.getAttribute("data-src")||"";this.input.src=t,this.input.loading="eager"}willRenderItems(){this.blankslate.hidden=this.list.size>0||this.loading}renderItem(e){const t=new d(this.itemTemplate,{id:e.detail.item.id,project_icon_hidden:e.detail.item.type!=="project",table_icon_hidden:e.detail.item.type!=="memex_project",name:e.detail.item.name,owner:e.detail.item.owner,type:e.detail.item.type,selected:this.isProjectSelected(e.detail.item)},p);e.detail.fragment.append(t)}isProjectSelected(e){var t;return(t=this.selectionDiff[e.type][e.id])!=null?t:e.selected}toggleItem(e){if(!(e.target instanceof HTMLInputElement)||e.target.type!=="checkbox")return;const t=e.target.closest("[data-project-id]");if(!t)return;const i=parseInt(t.getAttribute("data-project-id")||"",10),r=t.getAttribute("data-project-type")||"";(t.getAttribute("aria-checked")||"")==="true"?(this.selectionDiff[r][i]=!1,t.setAttribute("aria-checked","false")):(this.selectionDiff[r][i]=!0,t.setAttribute("aria-checked","true")),this.serializeSelection()}createSubmitSelection(e,t,i){const r=`${e==="memex_project"?"issue_memex_project_ids":"issue_project_ids"}[${t.toString()}]`;return new d(this.selectionTemplate,{name:r,checked:i,type:i?"checkbox":"hidden"},p)}serializeSelection(){this.submitContainer.replaceChildren();for(const[e,t]of Object.entries(this.selectionDiff.project))this.submitContainer.append(this.createSubmitSelection("project",e,t));for(const[e,t]of Object.entries(this.selectionDiff.memex_project))this.submitContainer.append(this.createSubmitSelection("memex_project",e,t))}loadChanges(){const e=/(\S+)\[([0-9]+)\]/;for(const t of Array.from(this.submitContainer.children)){const i=t.getAttribute("name");if(i===null)continue;const r=i.match(e);if(!r)continue;const s=r[1],l=parseInt(r[2],10);switch(s){case"issue_project_ids":this.selectionDiff.project[l]=!0;break;case"issue_memex_project_ids":this.selectionDiff.memex_project[l]=!0;break;default:throw new Error(`Unknown checkbox name: ${t.getAttribute("name")}`)}}}};f(n,"ProjectPickerElement"),c([o],n.prototype,"input",2),c([o],n.prototype,"list",2),c([o],n.prototype,"itemTemplate",2),c([o],n.prototype,"selectionTemplate",2),c([o],n.prototype,"submitContainer",2),c([o],n.prototype,"blankslate",2),c([o],n.prototype,"loadingIndicator",2),n=c([m],n)}}});
//# sourceMappingURL=chunk-project-picker-element-1ef6c7c1.js.map
