System.register(["./chunk-vendor.js","./chunk-linear.js","./chunk-time.js","./chunk-frameworks.js","./chunk-tip.js","./chunk-format-symbol.js","./chunk-array.js","./chunk-axis.js","./chunk-line.js","./chunk-pointer.js"],function(){"use strict";var T,M,D,_,E,W,S,O,P,G,F,H,z,B,U,m,x,V,R,N,Y;return{setters:[function(s){T=s.a,M=s.t,D=s.c},function(s){_=s.f,E=s.b,W=s.l,S=s.s,O=s.m},function(s){P=s.m,G=s.s},function(s){F=s.I,H=s.m,z=s.aT},function(s){B=s.d},function(s){U=s.f},function(s){m=s.t,x=s.d},function(s){V=s.a,R=s.b},function(s){N=s.l},function(s){Y=s.p}],execute:function(){var s=Object.defineProperty,dt=Object.getOwnPropertyDescriptor,a=(t,e)=>s(t,"name",{value:e,configurable:!0}),J=(t,e,n,r)=>{for(var c=r>1?void 0:r?dt(e,n):e,l=t.length-1,i;l>=0;l--)(i=t[l])&&(c=(r?i(e,n,c):i(c))||c);return r&&c&&s(e,n,c),c};const ut=H(K);async function K(t){return await(await z(t,{headers:{accept:"application/json"}})).json()}a(K,"fetchData");let b=class extends HTMLElement{async connectedCallback(){const t=this.graph,e=t.getAttribute("data-url");if(!!e){for(const n of t.querySelectorAll("svg.viz"))n.remove();t.classList.add("is-graph-loading"),t.classList.remove("is-graph-load-error","is-graph-empty");try{const n=await ut(e);t.classList.remove("is-graph-loading"),n!=null&&n.unusable?t.classList.add("is-graph-without-usable-data"):n!=null&&n.length===0||n!=null&&n.summary!=null&&n.summary.total===0||n[0]!=null&&n[0].weeks!=null&&n[0].weeks.length===0?t.classList.add("is-graph-empty"):st(t,n)}catch(n){throw t.classList.remove("is-graph-loading"),t.classList.add("is-graph-load-error"),n}}}};a(b,"OrgInsightsGraphElement"),J([M],b.prototype,"graph",2),b=J([D],b);const p={top:20,right:40,bottom:30,left:40},L=_(","),A=m("%A, %B %-d, %Y"),pt=m("%b"),ft=m("%a %-d"),ht=m("%-d"),Q=768;function X(t){let e=pt(t);return window.innerWidth<Q&&(e=e[0]),e}a(X,"responsiveAbbreviatedMonth");function I(t){return window.innerWidth<Q?ht(t):ft(t)}a(I,"responsiveWeekdayDate");const Z={year:{forTooltip:t=>`Week of ${A(t)}`,forGraphTick:X,ticks:P.every(1)},month:{forTooltip:A,forGraphTick:I,ticks:x.filter(t=>x.count(0,t)%4===0)},week:{forTooltip:A,forGraphTick:I,ticks:x.every(1)}};function tt(t,e){t<0?e.classList.add("is-decrease","color-fg-danger"):t>0?e.classList.add("is-increase","color-fg-success"):e.classList.add("color-fg-muted"),e.querySelector(".js-change-num").textContent=`${L(Math.abs(t))}%`}a(tt,"percentChangeUpdate");function et(t){return Z[t]||Z.month}a(et,"dateFormattersFor");function nt(t){let e=t.clientWidth;if(e===0){const n=t.closest("[hidden]");n instanceof HTMLElement&&(n.hidden=!1,e=t.clientWidth,n.hidden=!0)}return e===0&&(e=914),e}a(nt,"getContainerWidth");function st(t,e){if(!e||e.error!=null)return;const n=t.closest(".js-org-insights-card"),r=et(e.timespan.period),c=E(o=>o.date).left,l=nt(t)-p.right-p.left,i=170;for(const[o,d]of e.metrics.entries()){const u=n.querySelector(`.js-metric[data-metric-index="${o}"] .js-total`);u!=null&&(u.textContent=L(d.total),tt(d.percent_change,n.querySelector(`.js-metric[data-metric-index="${o}"] .js-percentage-change`)))}const g=B().attr("class","org-insights-svg-tip total-unique comparison border color-shadow-medium f6 color-bg-default rounded-1").offset([-10,0]).html(o=>`<p class="f6 color-fg-muted mb-1">${r.forTooltip(o.date)}</p>
         <ul> ${e.metrics.map((d,u)=>`<li class="totals metric-${u} d-flex flex-items-center">
                  <div class="legend mr-1"></div>
                  <span class="text-bold mr-1">${L(o[d.display_name])}</span>
                  ${d.display_name}
                </li>`).join(`
`)}
        </ul>`),y=G().range([0,l]),k=W().range([i,0]),mt=V(y).tickSize(i+5).tickPadding(10).ticks(r.ticks).tickFormat(r.forGraphTick),gt=R(k).ticks(3).tickFormat(U),yt=N().x(o=>y(o.date)).y(o=>k(o.count)),h=S(t).append("svg").attr("width",l+p.left+p.right).attr("height",i+p.top+p.bottom).attr("class","vis").append("g").attr("transform",`translate(${p.left},${p.top})`).call(g);y.domain([e.timespan.beginning,e.timespan.ending]),k.domain([0,O(e.metrics.map(o=>o.max))]),h.append("g").attr("class","x axis").call(mt).selectAll("text").attr("text-anchor","middle"),h.append("g").attr("class","y axis").call(gt);const it=e.metrics.map(o=>o.counts);h.selectAll("path.path").data(it).enter().append("path").attr("class",(o,d)=>`dots total metric-${d||0}`).attr("d",yt),h.selectAll("g.dots").data(it).enter().append("g").attr("class",(o,d)=>`dots totals metric-${d||0}`).each(function(){S(this).selectAll("circle").data(o=>o).enter().append("circle").attr("cx",o=>y(o.date)).attr("cy",o=>k(o.count)).attr("r",2)}),h.append("rect").attr("class","overlay").attr("width",l).attr("height",i).on("mousemove",a(function(d){const u={},q=y.invert(Y(d)[0]),j=e.metrics[0].counts,w=c(j,q,1),vt=j[w-1],at=j[w],C=at&&q-vt.date>at.date-q?w:w-1,lt=j[C];if(lt){u.date=lt.date;for(const f of e.metrics){const v=f.counts[C];u[f.display_name]=v?v.count:0}const xt=Math.max(...e.metrics.map(f=>{const v=f.counts[C];return v?v.count:0}),0),bt=h.selectAll("g.dots circle").filter(f=>f&&f.date===u.date&&f.count===xt);g.show.call(this,{target:bt.node()},u),g.attr("hidden",null)}},"showFocusedValue")).on("mouseout",function(){setTimeout(()=>{g.hide(),g.attr("hidden","hidden")},500)}),n.classList.add("is-rendered")}a(st,"render");function ot(t,e){const n=t.querySelector(`input[value='${e.value}'][name='repos[]']`);if(n instanceof HTMLInputElement)n.checked=!0;else{const r=e.cloneNode(!0);t.appendChild(r)}$(t)}a(ot,"addItemToForm");function rt(t,e){const n=t.querySelector(`input[value='${e.value}'][name='repos[]']`);n instanceof HTMLInputElement&&n.remove(),$(t)}a(rt,"removeItemFromForm");function $(t){const e=t.querySelector(".js-repo-filter-apply-btn"),n=new URLSearchParams(window.location.search).getAll("repos[]"),r=[];for(const i of t.elements)i instanceof HTMLInputElement&&i.name==="repos[]"&&r.push(i.value);const c=t.querySelector(".js-max-repo-error");if(r.length>3){c.hidden=!1,e.disabled=!0;return}c.hidden=!0;const l=new Set([...n,...r]);e.disabled=n.length===r.length&&l.size===n.length}a($,"validateForm");function ct(t,e){const n=[];for(const r of t.elements)r instanceof HTMLInputElement&&r.name==="repos[]"&&n.push(r.value);return n.includes(e.toString())}a(ct,"isSelected"),T("loadend",".js-repo-filter",function(t){const e=t.currentTarget.closest(".js-org-insights-repo-menu"),n=e.querySelectorAll(".js-org-insights-repo-checkbox"),r=e.querySelector(".js-selected-repo-form");for(const c of n)ct(r,c.value)?F(c,!0):F(c,!1)},{capture:!0}),T("details-menu-selected",".js-org-insights-repo-menu",function(t){const e=t.currentTarget.closest(".js-org-insights-repo-details"),n=e.querySelector(".js-selected-repo-form"),c=t.detail.relatedTarget.querySelector(".js-org-insights-repo-checkbox");c.checked?ot(n,c):rt(n,c);const l=n.querySelectorAll('input[type="checkbox"]:checked').length,i=e.querySelector(".js-insights-repo-count");l===0?i.textContent="All":i.textContent=`${l} selected`},{capture:!0})}}});
//# sourceMappingURL=chunk-org-insights-graph-element-50b4598c.js.map
